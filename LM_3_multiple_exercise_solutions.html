<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Exercise Solutions</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 60px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h2 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h3 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h4 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h5 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h6 {
  padding-top: 65px;
  margin-top: -65px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">BI5009</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li>
  <a href="setup.html">
    <span class="fa fa-cog"></span>
     
    Setup
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-desktop"></span>
     
    Learn
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="howto.html">
        <span class="fa fa-tv"></span>
         
        How-to
      </a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-book"></span>
     
    R Book
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="https://intro2r.com">
        <span class="fa fa-firefox"></span>
         
        Web book
      </a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="https://github.com/alexd106/Rbook/raw/master/docs/Rbook.pdf">
        <span class="fa fa-file-pdf"></span>
         
        PDF book
      </a>
    </li>
  </ul>
</li>
<li>
  <a href="exercises.html">
    <span class="fa fa-book"></span>
     
    Exercises
  </a>
</li>
<li>
  <a href="exercise_solutions.html">
    <span class="fa fa-book"></span>
     
    Exercise Solutions
  </a>
</li>
<li>
  <a href="data.html">
    <span class="fa fa-download"></span>
     
    Data
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-question-circle"></span>
     
    Info
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="resources.html">
        <span class="fa fa-book"></span>
         
        Resources
      </a>
    </li>
    <li>
      <a href="https://github.com/alexd106/BI5009">
        <span class="fa fa-github fa-lg"></span>
         
        Source code
      </a>
    </li>
    <li>
      <a href="https://twitter.com/Scedacity">
        <span class="fa fa-twitter fa-lg"></span>
         
        Twitter
      </a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Exercise Solutions</h1>

</div>


<p> </p>
<div id="exercise-1-linear-model-with-additive-continuous-and-categorical-predictors-explanatory-variables" class="section level1">
<h1>Exercise 1: Linear model with additive continuous and categorical predictors (= explanatory variables)</h1>
<p> </p>
<p>This exercise builds on the linear model with one continuous predictor, and the linear model with one categorical predictor, by adding these two sources of variation in the same model.</p>
<p> </p>
<ol style="list-style-type: decimal">
<li>As in previous exercises, either create a new R script (perhaps call it linear_model_3) or continue with your previous R script in your RStudio Project. Again, make sure you include any metadata you feel is appropriate (title, description of task, date of creation etc) and don’t forget to comment out your metadata with a <code>#</code> at the beginning of the line.</li>
</ol>
<p> </p>
<ol start="2" style="list-style-type: decimal">
<li>Import the data file ‘loyn.txt’ into R and take a look at the structure of this dataframe using the <code>str()</code> function. We know that the abundance of birds <code>ABUND</code> increases quickly with the area of the patch <code>LOGAREA</code>, and more slowly for the larger patches (a saturating “log-linear relationship”). We now also know that bird abundance changes in a non-linear way with the grazing intensity <code>FGRAZE</code>. But how do these effects combine together? Would a small patch with low grazing intensity have more birds than a larger patch with high grazing intensity? Could the poor fit of the <code>ABUND ~ LOGAREA</code> model for the large patches be improved, if we accounted for grazing intensity in the patches?</li>
</ol>
<p> </p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>loyn &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;./data/loyn.txt&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw">str</span>(loyn)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="co">## &#39;data.frame&#39;:    56 obs. of  8 variables:</span></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="co">##  $ Site   : int  1 2 3 4 5 6 7 8 9 10 ...</span></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="co">##  $ ABUND  : num  5.3 2 1.5 17.1 13.8 14.1 3.8 2.2 3.3 3 ...</span></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="co">##  $ AREA   : num  0.1 0.5 0.5 1 1 1 1 1 1 1 ...</span></span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="co">##  $ DIST   : int  39 234 104 66 246 234 467 284 156 311 ...</span></span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="co">##  $ LDIST  : int  39 234 311 66 246 285 467 1829 156 571 ...</span></span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="co">##  $ YR.ISOL: int  1968 1920 1900 1966 1918 1965 1955 1920 1965 1900 ...</span></span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="co">##  $ GRAZE  : int  2 5 5 3 5 3 5 5 4 5 ...</span></span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="co">##  $ ALT    : int  160 60 140 160 140 130 90 60 130 130 ...</span></span></code></pre></div>
<p> </p>
<ol start="3" style="list-style-type: decimal">
<li>As previously we want to treat <code>AREA</code> as a log-transformed area to limit the influence of the few disproportionately large patches, and <code>GRAZE</code> as a categorical variable with five levels. So the first thing we need to do is create the corresponding variables in the loyn dataframe, called <code>LOGAREA</code> and <code>FGRAZE</code>.</li>
</ol>
<p> </p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>loyn<span class="op">$</span>LOGAREA &lt;-<span class="st"> </span><span class="kw">log10</span>(loyn<span class="op">$</span>AREA)</span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="co"># create factor GRAZE as it was originally coded as an integer</span></span>
<span id="cb2-3"><a href="#cb2-3"></a>loyn<span class="op">$</span>FGRAZE &lt;-<span class="st"> </span><span class="kw">factor</span>(loyn<span class="op">$</span>GRAZE)</span></code></pre></div>
<p> </p>
<ol start="4" style="list-style-type: decimal">
<li>Explore the relationship between grazing and patch area, using a scatterplot. Hint: you may want to use <code>GRAZE</code> rather than <code>FGRAZE</code> for this. Is there any variability in patch area within each grazing level? Is the sampling design balanced, i.e., is the whole range of patch areas evenly represented at each grazing level?</li>
</ol>
<p> </p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="kw">plot</span>(LOGAREA <span class="op">~</span><span class="st"> </span>GRAZE, <span class="dt">xlab =</span> <span class="st">&quot;Grazing level&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Patch area&quot;</span>, <span class="dt">data =</span> loyn)</span></code></pre></div>
<p><img src="LM_3_multiple_exercise_solutions_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a></span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="co"># There is a good spread of patch areas within each grazing level overall,</span></span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="co"># although there is a trend for more grazing the smaller the patch is.</span></span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="co"># the lowest level of grazing intensity happens to be predominantly in larger patches (including the two monster patches)</span></span>
<span id="cb4-5"><a href="#cb4-5"></a></span>
<span id="cb4-6"><a href="#cb4-6"></a><span class="co"># How would we expect adding grazing level to the LOGAREA model to affect the predictions of the model? Think particularly of the largest two patches which were previously overestimated by the model (negative residuals - see the linear model 1 exercise)?</span></span>
<span id="cb4-7"><a href="#cb4-7"></a><span class="co"># Since the lowest grazing levels appear to be associated with the highest bird abundances, </span></span>
<span id="cb4-8"><a href="#cb4-8"></a><span class="co"># we could expect a model combining area and grazing level to predict an even higher abundance for these patches </span></span>
<span id="cb4-9"><a href="#cb4-9"></a><span class="co"># this would not improve the situation for these patches, at least. But let&#39;s find out if that&#39;s the case!</span></span></code></pre></div>
<p> </p>
<ol start="5" style="list-style-type: decimal">
<li>You could explore the joint effect of <code>FGRAZE</code> and <code>LOGAREA</code> on <code>ABUND</code>, using panel plots. Hint: See the function <code>coplot</code> in the Data exploration lecture slide 24, and/or the help page for <code>coplot</code>. Factor levels increase from the bottom-left panel to the top-right panel. What pattern do you see? What do you expect your model results to look like?</li>
</ol>
<p> </p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="kw">coplot</span>(ABUND <span class="op">~</span><span class="st"> </span>LOGAREA <span class="op">|</span><span class="st"> </span>FGRAZE, <span class="dt">data =</span> loyn)</span></code></pre></div>
<p><img src="LM_3_multiple_exercise_solutions_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a></span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="co"># There is a lot of variation in there, but:</span></span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="co"># The mean abundance seems to decrease as grazing levels increase. Most noticeable in the highest grazing level.</span></span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="co"># For a given grazing level, the abundance seems to increase with the log-patch area.</span></span>
<span id="cb6-5"><a href="#cb6-5"></a><span class="co"># It is unclear from this if the slope of the log-area effect is different between grazing levels</span></span></code></pre></div>
<p> </p>
<ol start="6" style="list-style-type: decimal">
<li>Fit an appropriate linear model in R to explain the variation in the response variable, <code>ABUND</code> with the explanatory variables <code>LOGAREA</code> and <code>FGRAZE</code> acting additively. Hint: <code>+</code> is the addition symbol!. Remember to use the <code>data =</code> argument. Assign this linear model to an appropriately named object, like <code>birds.add.1</code> (yes, you could be right if you sense there are more of these to come).</li>
</ol>
<p> </p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>birds.add<span class="fl">.1</span> &lt;-<span class="st"> </span><span class="kw">lm</span>(ABUND <span class="op">~</span><span class="st"> </span>LOGAREA <span class="op">+</span><span class="st"> </span>FGRAZE, <span class="dt">data =</span> loyn)</span></code></pre></div>
<p> </p>
<ol start="7" style="list-style-type: decimal">
<li>Produce the ANOVA table using the <code>anova()</code> function on the model object. What null hypotheses are being tested? Hint: the <code>anova()</code> function performs sequential tests. Do you reject or fail to reject the null hypotheses? What percentage of variation does the model explain overall? Hint: (SST-SSE)/SST. How much do <code>LOGAREA</code> and <code>FGRAZE</code> explain respectively?</li>
</ol>
<p> </p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="kw">anova</span>(birds.add<span class="fl">.1</span>)</span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="co">## Analysis of Variance Table</span></span>
<span id="cb8-3"><a href="#cb8-3"></a><span class="co">## </span></span>
<span id="cb8-4"><a href="#cb8-4"></a><span class="co">## Response: ABUND</span></span>
<span id="cb8-5"><a href="#cb8-5"></a><span class="co">##           Df Sum Sq Mean Sq  F value    Pr(&gt;F)    </span></span>
<span id="cb8-6"><a href="#cb8-6"></a><span class="co">## LOGAREA    1 3471.0  3471.0 100.2944 1.530e-13 ***</span></span>
<span id="cb8-7"><a href="#cb8-7"></a><span class="co">## FGRAZE     4 1136.5   284.1   8.2101 3.598e-05 ***</span></span>
<span id="cb8-8"><a href="#cb8-8"></a><span class="co">## Residuals 50 1730.4    34.6                       </span></span>
<span id="cb8-9"><a href="#cb8-9"></a><span class="co">## ---</span></span>
<span id="cb8-10"><a href="#cb8-10"></a><span class="co">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb8-11"><a href="#cb8-11"></a></span>
<span id="cb8-12"><a href="#cb8-12"></a><span class="co"># null hypothesis 1: There is no effect of LOGAREA on ABUND (the coefficient for LOGAREA is zero)</span></span>
<span id="cb8-13"><a href="#cb8-13"></a><span class="co"># null hypothesis 2: There is no effect of FGRAZE on ABUND (no difference between grazing levels *after* the effect of LOGAREA)</span></span>
<span id="cb8-14"><a href="#cb8-14"></a><span class="co"># the p values are all very small therefore reject both null hypotheses.</span></span>
<span id="cb8-15"><a href="#cb8-15"></a></span>
<span id="cb8-16"><a href="#cb8-16"></a><span class="co"># Proportions of variation can all be calculated by hand by copy-paste of the Sum Sq values if you prefer, but</span></span>
<span id="cb8-17"><a href="#cb8-17"></a><span class="co"># we can extract the Sums of squares like this:</span></span>
<span id="cb8-18"><a href="#cb8-18"></a><span class="kw">str</span>(<span class="kw">anova</span>(birds.add<span class="fl">.1</span>)) <span class="co"># examine the structure of the returned object</span></span>
<span id="cb8-19"><a href="#cb8-19"></a><span class="co">## Classes &#39;anova&#39; and &#39;data.frame&#39;:    3 obs. of  5 variables:</span></span>
<span id="cb8-20"><a href="#cb8-20"></a><span class="co">##  $ Df     : int  1 4 50</span></span>
<span id="cb8-21"><a href="#cb8-21"></a><span class="co">##  $ Sum Sq : num  3471 1137 1730</span></span>
<span id="cb8-22"><a href="#cb8-22"></a><span class="co">##  $ Mean Sq: num  3471 284.1 34.6</span></span>
<span id="cb8-23"><a href="#cb8-23"></a><span class="co">##  $ F value: num  100.29 8.21 NA</span></span>
<span id="cb8-24"><a href="#cb8-24"></a><span class="co">##  $ Pr(&gt;F) : num  1.53e-13 3.60e-05 NA</span></span>
<span id="cb8-25"><a href="#cb8-25"></a><span class="co">##  - attr(*, &quot;heading&quot;)= chr  &quot;Analysis of Variance Table\n&quot; &quot;Response: ABUND&quot;</span></span>
<span id="cb8-26"><a href="#cb8-26"></a>birds.add.<span class="fl">1.</span>SS&lt;-<span class="st"> </span><span class="kw">anova</span>(birds.add<span class="fl">.1</span>)<span class="op">$</span><span class="st">&#39;Sum Sq&#39;</span> <span class="co"># store values of interest</span></span>
<span id="cb8-27"><a href="#cb8-27"></a>birds.add.<span class="fl">1.</span>SS <span class="co"># checking that we have extracted the Sums of squares as intended</span></span>
<span id="cb8-28"><a href="#cb8-28"></a><span class="co">## [1] 3470.985 1136.545 1730.399</span></span>
<span id="cb8-29"><a href="#cb8-29"></a></span>
<span id="cb8-30"><a href="#cb8-30"></a>birds.add.<span class="fl">1.</span>SST&lt;-<span class="st"> </span><span class="kw">sum</span>(<span class="kw">anova</span>(birds.add<span class="fl">.1</span>)<span class="op">$</span><span class="st">&#39;Sum Sq&#39;</span>) <span class="co"># compute SST</span></span>
<span id="cb8-31"><a href="#cb8-31"></a></span>
<span id="cb8-32"><a href="#cb8-32"></a><span class="co"># proportion of variation in the data explained by the model:</span></span>
<span id="cb8-33"><a href="#cb8-33"></a>(birds.add.<span class="fl">1.</span>SST <span class="op">-</span><span class="st"> </span>birds.add.<span class="fl">1.</span>SS[<span class="dv">3</span>]) <span class="op">/</span><span class="st"> </span>birds.add.<span class="fl">1.</span>SST <span class="co"># 0.7269773</span></span>
<span id="cb8-34"><a href="#cb8-34"></a><span class="co">## [1] 0.7269773</span></span>
<span id="cb8-35"><a href="#cb8-35"></a></span>
<span id="cb8-36"><a href="#cb8-36"></a><span class="co"># proportion of variation in the data explained by predictors:</span></span>
<span id="cb8-37"><a href="#cb8-37"></a>(birds.add.<span class="fl">1.</span>SS[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]) <span class="op">/</span><span class="st"> </span>birds.add.<span class="fl">1.</span>SST <span class="co"># 0.5476530 0.1793243</span></span>
<span id="cb8-38"><a href="#cb8-38"></a><span class="co">## [1] 0.5476530 0.1793243</span></span>
<span id="cb8-39"><a href="#cb8-39"></a></span>
<span id="cb8-40"><a href="#cb8-40"></a><span class="co"># So that&#39;s 55% for LOGAREA and 18% for FGRAZE after LOGAREA</span></span></code></pre></div>
<p> </p>
<ol start="8" style="list-style-type: decimal">
<li>Since the <code>anova()</code> function does sequential tests of the effects, the results could be different if we put <code>FGRAZE</code> first. Run the corresponding model and its analysis of variance. What null hypotheses are being tested? Do you reject or fail to reject the null hypotheses? What percentage of variation does the model explain overall? Hint: (SST-SSE)/SST. How much do <code>LOGAREA</code> and <code>FGRAZE</code> explain respectively?</li>
</ol>
<p> </p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>birds.add<span class="fl">.2</span> &lt;-<span class="st"> </span><span class="kw">lm</span>(ABUND <span class="op">~</span><span class="st"> </span>FGRAZE <span class="op">+</span><span class="st"> </span>LOGAREA, <span class="dt">data =</span> loyn)</span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="kw">anova</span>(birds.add<span class="fl">.2</span>)</span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="co">## Analysis of Variance Table</span></span>
<span id="cb9-4"><a href="#cb9-4"></a><span class="co">## </span></span>
<span id="cb9-5"><a href="#cb9-5"></a><span class="co">## Response: ABUND</span></span>
<span id="cb9-6"><a href="#cb9-6"></a><span class="co">##           Df Sum Sq Mean Sq F value    Pr(&gt;F)    </span></span>
<span id="cb9-7"><a href="#cb9-7"></a><span class="co">## FGRAZE     4 3453.7  863.42  24.949 2.156e-11 ***</span></span>
<span id="cb9-8"><a href="#cb9-8"></a><span class="co">## LOGAREA    1 1153.8 1153.85  33.340 4.901e-07 ***</span></span>
<span id="cb9-9"><a href="#cb9-9"></a><span class="co">## Residuals 50 1730.4   34.61                      </span></span>
<span id="cb9-10"><a href="#cb9-10"></a><span class="co">## ---</span></span>
<span id="cb9-11"><a href="#cb9-11"></a><span class="co">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb9-12"><a href="#cb9-12"></a></span>
<span id="cb9-13"><a href="#cb9-13"></a><span class="co"># null hypothesis 1: There is no effect of FGRAZE on ABUND (no difference between grazing levels)</span></span>
<span id="cb9-14"><a href="#cb9-14"></a><span class="co"># null hypothesis 2: There is no effect of LOGAREA on ABUND (the coefficient for LOGAREA is zero *after* the effect of FGRAZE)</span></span>
<span id="cb9-15"><a href="#cb9-15"></a><span class="co"># the p values are all very small therefore reject both null hypotheses.</span></span>
<span id="cb9-16"><a href="#cb9-16"></a></span>
<span id="cb9-17"><a href="#cb9-17"></a><span class="co"># we can also extract the Sums of squares like this:</span></span>
<span id="cb9-18"><a href="#cb9-18"></a>birds.add.<span class="fl">2.</span>SS&lt;-<span class="st"> </span><span class="kw">anova</span>(birds.add<span class="fl">.2</span>)<span class="op">$</span><span class="st">&#39;Sum Sq&#39;</span> <span class="co"># store values of interest</span></span>
<span id="cb9-19"><a href="#cb9-19"></a>birds.add.<span class="fl">2.</span>SST&lt;-<span class="st"> </span><span class="kw">sum</span>(<span class="kw">anova</span>(birds.add<span class="fl">.2</span>)<span class="op">$</span><span class="st">&#39;Sum Sq&#39;</span>) <span class="co"># compute SST</span></span>
<span id="cb9-20"><a href="#cb9-20"></a></span>
<span id="cb9-21"><a href="#cb9-21"></a><span class="co"># proportion of variation in the data explained by the model:</span></span>
<span id="cb9-22"><a href="#cb9-22"></a>(birds.add.<span class="fl">2.</span>SST <span class="op">-</span><span class="st"> </span>birds.add.<span class="fl">2.</span>SS[<span class="dv">3</span>]) <span class="op">/</span><span class="st"> </span>birds.add.<span class="fl">2.</span>SST <span class="co"># the same as the previous model</span></span>
<span id="cb9-23"><a href="#cb9-23"></a><span class="co">## [1] 0.7269773</span></span>
<span id="cb9-24"><a href="#cb9-24"></a></span>
<span id="cb9-25"><a href="#cb9-25"></a><span class="co"># proportion of variation in the data explained by predictors:</span></span>
<span id="cb9-26"><a href="#cb9-26"></a>(birds.add.<span class="fl">2.</span>SS[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]) <span class="op">/</span><span class="st"> </span>birds.add.<span class="fl">2.</span>SST <span class="co"># 0.5449233 0.1820540</span></span>
<span id="cb9-27"><a href="#cb9-27"></a><span class="co">## [1] 0.5449233 0.1820540</span></span>
<span id="cb9-28"><a href="#cb9-28"></a></span>
<span id="cb9-29"><a href="#cb9-29"></a><span class="co"># So that&#39;s 54% for LOGAREA and 18% for FGRAZE after LOGAREA, essentially reversing the contributions found in the first model.</span></span>
<span id="cb9-30"><a href="#cb9-30"></a><span class="co"># Conclusion: here the order matters a lot. This is not too surprising since the design is unbalanced and FGRAZE and LOGAREA covary (they are correlated)</span></span></code></pre></div>
<p> </p>
<ol start="9" style="list-style-type: decimal">
<li>Use the <code>summary()</code> function on the first model object to produce the table of parameter estimates. Using this output take each line in turn and answer the following questions: (A) what does this parameter represent, mathematically? (B) What is the biological interpretation of the corresponding estimate? (C) What is the null hypothesis associated with it? (D) Do you reject or fail to reject this hypothesis?</li>
</ol>
<p> </p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="kw">summary</span>(birds.add<span class="fl">.1</span>)</span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="co">## </span></span>
<span id="cb10-3"><a href="#cb10-3"></a><span class="co">## Call:</span></span>
<span id="cb10-4"><a href="#cb10-4"></a><span class="co">## lm(formula = ABUND ~ LOGAREA + FGRAZE, data = loyn)</span></span>
<span id="cb10-5"><a href="#cb10-5"></a><span class="co">## </span></span>
<span id="cb10-6"><a href="#cb10-6"></a><span class="co">## Residuals:</span></span>
<span id="cb10-7"><a href="#cb10-7"></a><span class="co">##      Min       1Q   Median       3Q      Max </span></span>
<span id="cb10-8"><a href="#cb10-8"></a><span class="co">## -16.0849  -2.4793  -0.0817   2.6486  11.6344 </span></span>
<span id="cb10-9"><a href="#cb10-9"></a><span class="co">## </span></span>
<span id="cb10-10"><a href="#cb10-10"></a><span class="co">## Coefficients:</span></span>
<span id="cb10-11"><a href="#cb10-11"></a><span class="co">##             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb10-12"><a href="#cb10-12"></a><span class="co">## (Intercept)  15.7164     2.7674   5.679 6.87e-07 ***</span></span>
<span id="cb10-13"><a href="#cb10-13"></a><span class="co">## LOGAREA       7.2472     1.2551   5.774 4.90e-07 ***</span></span>
<span id="cb10-14"><a href="#cb10-14"></a><span class="co">## FGRAZE2       0.3826     2.9123   0.131 0.895993    </span></span>
<span id="cb10-15"><a href="#cb10-15"></a><span class="co">## FGRAZE3      -0.1893     2.5498  -0.074 0.941119    </span></span>
<span id="cb10-16"><a href="#cb10-16"></a><span class="co">## FGRAZE4      -1.5916     2.9762  -0.535 0.595182    </span></span>
<span id="cb10-17"><a href="#cb10-17"></a><span class="co">## FGRAZE5     -11.8938     2.9311  -4.058 0.000174 ***</span></span>
<span id="cb10-18"><a href="#cb10-18"></a><span class="co">## ---</span></span>
<span id="cb10-19"><a href="#cb10-19"></a><span class="co">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb10-20"><a href="#cb10-20"></a><span class="co">## </span></span>
<span id="cb10-21"><a href="#cb10-21"></a><span class="co">## Residual standard error: 5.883 on 50 degrees of freedom</span></span>
<span id="cb10-22"><a href="#cb10-22"></a><span class="co">## Multiple R-squared:  0.727,  Adjusted R-squared:  0.6997 </span></span>
<span id="cb10-23"><a href="#cb10-23"></a><span class="co">## F-statistic: 26.63 on 5 and 50 DF,  p-value: 5.148e-13</span></span>
<span id="cb10-24"><a href="#cb10-24"></a></span>
<span id="cb10-25"><a href="#cb10-25"></a><span class="co"># Here the intercept (baseline) is *NOT* the mean abundance of birds for FGRAZE level 1. It is the predicted `ABUND` for LOGAREA = 0, for FGRAZE level 1.</span></span>
<span id="cb10-26"><a href="#cb10-26"></a><span class="co"># the null hypothesis for the intercept is that the intercept = 0.</span></span>
<span id="cb10-27"><a href="#cb10-27"></a><span class="co"># As the p value (p &lt; 2e-16) is very small we reject this null hypothesis and conclude that the</span></span>
<span id="cb10-28"><a href="#cb10-28"></a><span class="co"># intercept is significantly different from 0. Not a biologically relevant hypothesis test, in this context (in fact totally arbitrary, as the location of the zero is determined by the transformation we chose)</span></span>
<span id="cb10-29"><a href="#cb10-29"></a></span>
<span id="cb10-30"><a href="#cb10-30"></a><span class="co"># For LOGAREA, the null hypothesis is that the slope of the relationship</span></span>
<span id="cb10-31"><a href="#cb10-31"></a><span class="co"># between LOGAREA and ABUND = 0 (no relationship)</span></span>
<span id="cb10-32"><a href="#cb10-32"></a></span>
<span id="cb10-33"><a href="#cb10-33"></a><span class="co"># The remaining estimates are differences (contrasts) between each level and the reference level, FGRAZE1. </span></span>
<span id="cb10-34"><a href="#cb10-34"></a><span class="co"># For example the FGRAZE2 estimate is 0.38, so there are 0.38 more birds on average in graze level 2 compared to graze level 1, *for a given patch area*.</span></span>
<span id="cb10-35"><a href="#cb10-35"></a><span class="co"># This difference is however not significantly different from zero (p = 0.895993). </span></span>
<span id="cb10-36"><a href="#cb10-36"></a></span>
<span id="cb10-37"><a href="#cb10-37"></a><span class="co"># The difference between graze level 5 (FGRAZE5) and the reference FGRAZE1 is </span></span>
<span id="cb10-38"><a href="#cb10-38"></a><span class="co"># -11.89 (11.89 fewer birds in graze 5 compared to graze 1), for *an identical patch area*.</span></span>
<span id="cb10-39"><a href="#cb10-39"></a><span class="co"># This difference is significantly different from 0 (p = 0.00017) and therefore the mean abundance of birds in graze level 5 is significantly lower than in graze level 1, for the same patch area.</span></span>
<span id="cb10-40"><a href="#cb10-40"></a></span>
<span id="cb10-41"><a href="#cb10-41"></a><span class="co"># The Multiple R-square value is as we calculated from the anova table</span></span></code></pre></div>
<p> </p>
<ol start="10" style="list-style-type: decimal">
<li>Now that you have interpreted all the coefficients, let’s check that it all fits together. Write down the equation of the model with the appropriate parameter estimates from the summary. By hand, calculate the predicted bird abundance (A) for a patch with <code>LOGAREA</code>= -0.5 and <code>GRAZE</code>= 1, and (B) for a patch with <code>LOGAREA</code>= -0.5 and <code>GRAZE</code>= 3. Can you predict the difference in expected abundance between (A) and (B) before doing the calculation? Hint: the difference between <code>GRAZE3</code> and <code>GRAZE1</code> for a given patch area. Now, predict (C) for <code>LOGAREA</code>= 0.5 and <code>GRAZE</code>= 3. What does the difference between (C) and (B) correspond to?</li>
</ol>
<p> </p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="co"># ABUND = 15.72*(Intercept) + 7.25*LOGAREA + 0.38*FGRAZE2 - 0.19*FGRAZE3 - 1.59*FGRAZE4 - 11.89*FGRAZE5</span></span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="co"># Note that (Intercept) = 1 always</span></span>
<span id="cb11-3"><a href="#cb11-3"></a></span>
<span id="cb11-4"><a href="#cb11-4"></a><span class="co"># expected abundance for (A): replace LOGAREA by -0.5, and all FGRAZE2...5 by 0</span></span>
<span id="cb11-5"><a href="#cb11-5"></a><span class="fl">15.72</span><span class="op">*</span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="fl">7.25</span><span class="op">*</span>(<span class="op">-</span><span class="fl">0.5</span>) <span class="op">+</span><span class="st"> </span><span class="fl">0.38</span><span class="op">*</span><span class="dv">0</span> <span class="op">-</span><span class="st"> </span><span class="fl">0.19</span><span class="op">*</span><span class="dv">0</span> <span class="op">-</span><span class="st"> </span><span class="fl">1.59</span><span class="op">*</span><span class="dv">0</span> <span class="op">-</span><span class="st"> </span><span class="fl">11.89</span><span class="op">*</span><span class="dv">0</span> <span class="co"># 12.095</span></span>
<span id="cb11-6"><a href="#cb11-6"></a><span class="co">## [1] 12.095</span></span>
<span id="cb11-7"><a href="#cb11-7"></a></span>
<span id="cb11-8"><a href="#cb11-8"></a><span class="co"># could also extract the model coefficients like this:</span></span>
<span id="cb11-9"><a href="#cb11-9"></a>birds.add.<span class="fl">1.</span>coef&lt;-<span class="st"> </span><span class="kw">coef</span>(birds.add<span class="fl">.1</span>)</span>
<span id="cb11-10"><a href="#cb11-10"></a>birds.add.<span class="fl">1.</span>coef</span>
<span id="cb11-11"><a href="#cb11-11"></a><span class="co">## (Intercept)     LOGAREA     FGRAZE2     FGRAZE3     FGRAZE4     FGRAZE5 </span></span>
<span id="cb11-12"><a href="#cb11-12"></a><span class="co">##  15.7163938   7.2472294   0.3826488  -0.1892869  -1.5915795 -11.8938327</span></span>
<span id="cb11-13"><a href="#cb11-13"></a><span class="co"># and multiply by the predictor values to obtain the equivalent prediction (difference due to my own roundings of estimates above)</span></span>
<span id="cb11-14"><a href="#cb11-14"></a><span class="kw">sum</span>(birds.add.<span class="fl">1.</span>coef <span class="op">*</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="fl">-0.5</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>)) <span class="co"># 12.09278 </span></span>
<span id="cb11-15"><a href="#cb11-15"></a><span class="co">## [1] 12.09278</span></span>
<span id="cb11-16"><a href="#cb11-16"></a></span>
<span id="cb11-17"><a href="#cb11-17"></a><span class="co"># expected abundance for (B): input 1 for the GRAZE3 variable</span></span>
<span id="cb11-18"><a href="#cb11-18"></a><span class="fl">15.72</span><span class="op">*</span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="fl">7.25</span><span class="op">*</span>(<span class="op">-</span><span class="fl">0.5</span>) <span class="op">+</span><span class="st"> </span><span class="fl">0.38</span><span class="op">*</span><span class="dv">0</span> <span class="op">-</span><span class="st"> </span><span class="fl">0.19</span><span class="op">*</span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="fl">1.59</span><span class="op">*</span><span class="dv">0</span> <span class="op">-</span><span class="st"> </span><span class="fl">11.89</span><span class="op">*</span><span class="dv">0</span> <span class="co"># 11.905</span></span>
<span id="cb11-19"><a href="#cb11-19"></a><span class="co">## [1] 11.905</span></span>
<span id="cb11-20"><a href="#cb11-20"></a><span class="co"># or</span></span>
<span id="cb11-21"><a href="#cb11-21"></a><span class="kw">sum</span>(birds.add.<span class="fl">1.</span>coef <span class="op">*</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="fl">-0.5</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>)) <span class="co"># 11.90349</span></span>
<span id="cb11-22"><a href="#cb11-22"></a><span class="co">## [1] 11.90349</span></span>
<span id="cb11-23"><a href="#cb11-23"></a></span>
<span id="cb11-24"><a href="#cb11-24"></a><span class="co"># the difference (B) 11.90349 - (A) 12.09278 should correspond to the estimate for the GRAZE3 coefficient</span></span>
<span id="cb11-25"><a href="#cb11-25"></a></span>
<span id="cb11-26"><a href="#cb11-26"></a><span class="co"># expected abundance for (C)</span></span>
<span id="cb11-27"><a href="#cb11-27"></a><span class="kw">sum</span>(birds.add.<span class="fl">1.</span>coef <span class="op">*</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="fl">0.5</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>)) <span class="co"># 19.15072</span></span>
<span id="cb11-28"><a href="#cb11-28"></a><span class="co">## [1] 19.15072</span></span>
<span id="cb11-29"><a href="#cb11-29"></a></span>
<span id="cb11-30"><a href="#cb11-30"></a><span class="co"># the difference (C) 19.15072 - (B) 11.90349 should coincide with the estimate of the slope for the LOGAREA effect, since there is just one LOGAREA unit of difference and the slope is the change in expected abundance for a 1-unit increase in the predictor.</span></span></code></pre></div>
<p> </p>
<ol start="11" style="list-style-type: decimal">
<li>Now let’s check the assumptions of your linear model by creating plots of the residuals from the model. Remember, that you can split your plotting device into 2 rows and 2 columns using the <code>par()</code> function before you create the plots. Check each of the assumptions using these plots and report whether your model meets these assumptions.</li>
</ol>
<p> </p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="co"># first split the plotting device into 2 rows and 2 columns</span></span>
<span id="cb12-2"><a href="#cb12-2"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb12-3"><a href="#cb12-3"></a></span>
<span id="cb12-4"><a href="#cb12-4"></a><span class="co"># now create the residuals plots</span></span>
<span id="cb12-5"><a href="#cb12-5"></a><span class="kw">plot</span>(birds.add<span class="fl">.1</span>)</span></code></pre></div>
<p><img src="LM_3_multiple_exercise_solutions_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a></span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="co"># To test the normality of residuals assumption we use the Normal Q-Q plot. </span></span>
<span id="cb13-3"><a href="#cb13-3"></a><span class="co"># The central residuals are not too far from the Q-Q line but the extremes are too extreme (the tails of the distribution are too long). Some observations, both high and low, are poorly explained by the model.</span></span>
<span id="cb13-4"><a href="#cb13-4"></a><span class="co"># The plot of the residuals against the fitted values suggests these extreme residuals happen for intermediate fitted values.</span></span>
<span id="cb13-5"><a href="#cb13-5"></a><span class="co"># Looking at the homogeneity of variance assumption (Residuals vs Fitted and Scale-Location plot),</span></span>
<span id="cb13-6"><a href="#cb13-6"></a><span class="co"># the graphs are mostly messy, with no clear pattern emerging. There is a hint of smaller variance with the lowest fitted values, which is not ideal.</span></span>
<span id="cb13-7"><a href="#cb13-7"></a><span class="co"># This could mean that the homogeneity of variance assumption is not met (i.e. the variances are not the same). </span></span>
<span id="cb13-8"><a href="#cb13-8"></a><span class="co"># The observations with the highest leverage don&#39;t appear to be overly influential, according to the Cook&#39;s distances in the Residuals vs Leverage plot.  </span></span>
<span id="cb13-9"><a href="#cb13-9"></a></span>
<span id="cb13-10"><a href="#cb13-10"></a><span class="co"># ABUND being bounded by zero, it wouldn&#39;t be too surprising that the variance increases with the mean abundance.</span></span>
<span id="cb13-11"><a href="#cb13-11"></a><span class="co"># This is often improved by log-transforming the response</span></span>
<span id="cb13-12"><a href="#cb13-12"></a>loyn<span class="op">$</span>logABUND&lt;-<span class="st"> </span><span class="kw">log</span>(loyn<span class="op">$</span>ABUND <span class="op">+</span><span class="st"> </span><span class="dv">1</span>) <span class="co"># here the natural log</span></span>
<span id="cb13-13"><a href="#cb13-13"></a>birds.add<span class="fl">.3</span> &lt;-<span class="st"> </span><span class="kw">lm</span>(logABUND <span class="op">~</span><span class="st"> </span>LOGAREA <span class="op">+</span><span class="st"> </span>FGRAZE, <span class="dt">data =</span> loyn)</span>
<span id="cb13-14"><a href="#cb13-14"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb13-15"><a href="#cb13-15"></a><span class="kw">plot</span>(birds.add<span class="fl">.3</span>)</span></code></pre></div>
<p><img src="LM_3_multiple_exercise_solutions_files/figure-html/unnamed-chunk-11-2.png" width="672" /></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a></span>
<span id="cb14-2"><a href="#cb14-2"></a><span class="co"># Not this time! Lots of extreme negative residuals generated.</span></span>
<span id="cb14-3"><a href="#cb14-3"></a></span>
<span id="cb14-4"><a href="#cb14-4"></a><span class="co"># Back to `birds.add.1` the other issue was the extreme residuals.</span></span>
<span id="cb14-5"><a href="#cb14-5"></a><span class="co"># This could be due to missing important predictors from the model, either new predictors altogether, </span></span>
<span id="cb14-6"><a href="#cb14-6"></a><span class="co"># or interactions: is it okay to assume the effect of LOGAREA to be the same for all grazing levels?</span></span></code></pre></div>
<p> </p>
<ol start="12" style="list-style-type: decimal">
<li>Let’s plot the predictions of your initial model to figure out how it really fits the data. Here’s a recipe, using the <code>predict()</code> function.</li>
</ol>
<ul>
<li>plot the raw data, using a different colour per <code>FGRAZE</code> level</li>
<li>for each <code>FGRAZE</code> level in turn,</li>
<li>create a sequence of <code>LOGAREA</code> from the minimum value to the maximum within the grazing level (unless you wish to predict outside the range of observed values)</li>
<li>store it in a data frame (e.g. <code>dat4pred</code>) containing the variables <code>FGRAZE</code> and <code>LOGAREA.</code> Remember that <code>FGRAZE</code> is a factor, so it requires double quotes.</li>
<li>add a predicted column containing the predictions of the model for the new data frame, using <code>predict()</code></li>
<li>plot the predictions with the appropriate colours</li>
</ul>
<p>See the script below, for one of many ways of doing this.</p>
<p> </p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="kw">par</span>(<span class="dt">mfrow=</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="kw">plot</span>(ABUND <span class="op">~</span><span class="st"> </span>LOGAREA, <span class="dt">data=</span> loyn, <span class="dt">col=</span> GRAZE, <span class="dt">pch=</span> <span class="dv">16</span>)</span>
<span id="cb15-3"><a href="#cb15-3"></a></span>
<span id="cb15-4"><a href="#cb15-4"></a><span class="co"># let&#39;s use a loop, to save repeating the following sequence 5 times:</span></span>
<span id="cb15-5"><a href="#cb15-5"></a><span class="cf">for</span>(g <span class="cf">in</span> <span class="kw">levels</span>(loyn<span class="op">$</span>FGRAZE)){<span class="co"># `g` will take the values &quot;1&quot;, &quot;2&quot;, &quot;3&quot;, &quot;4&quot; and &quot;5&quot; in turn</span></span>
<span id="cb15-6"><a href="#cb15-6"></a>    LOGAREA.seq&lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dt">from=</span> <span class="kw">min</span>(loyn<span class="op">$</span>LOGAREA[loyn<span class="op">$</span>FGRAZE <span class="op">==</span><span class="st"> </span>g]),</span>
<span id="cb15-7"><a href="#cb15-7"></a>                                        <span class="dt">to=</span> <span class="kw">max</span>(loyn<span class="op">$</span>LOGAREA[loyn<span class="op">$</span>FGRAZE <span class="op">==</span><span class="st"> </span>g]),</span>
<span id="cb15-8"><a href="#cb15-8"></a>                                                        <span class="dt">length=</span> <span class="dv">20</span>)</span>
<span id="cb15-9"><a href="#cb15-9"></a>    dat4pred&lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">FGRAZE=</span> g, <span class="dt">LOGAREA=</span> LOGAREA.seq)</span>
<span id="cb15-10"><a href="#cb15-10"></a>    dat4pred<span class="op">$</span>predicted&lt;-<span class="st"> </span><span class="kw">predict</span>(birds.add<span class="fl">.1</span>, <span class="dt">newdata=</span> dat4pred)</span>
<span id="cb15-11"><a href="#cb15-11"></a>    <span class="kw">lines</span>(predicted <span class="op">~</span><span class="st"> </span>LOGAREA, <span class="dt">data=</span> dat4pred, <span class="dt">col=</span> <span class="kw">as.numeric</span>(g), <span class="dt">lwd=</span> <span class="dv">2</span>)</span>
<span id="cb15-12"><a href="#cb15-12"></a>}</span></code></pre></div>
<p><img src="LM_3_multiple_exercise_solutions_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p> </p>
<ol start="13" style="list-style-type: decimal">
<li>What have we learned from this analysis so far?</li>
</ol>
<p> </p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="co"># There is a significant effect of grazing levels, especially the highest level with a negative effect on bird abundance</span></span>
<span id="cb16-2"><a href="#cb16-2"></a></span>
<span id="cb16-3"><a href="#cb16-3"></a><span class="co"># There is a significant positive effect of patch area, too.</span></span>
<span id="cb16-4"><a href="#cb16-4"></a></span>
<span id="cb16-5"><a href="#cb16-5"></a><span class="co"># The relative importance of patch area and grazing is not clear, as these are correlated, with smaller patches also having higher grazing intensity on average, and larger patches lower grazing intensity.</span></span>
<span id="cb16-6"><a href="#cb16-6"></a></span>
<span id="cb16-7"><a href="#cb16-7"></a><span class="co"># Some observations are poorly predicted (fitted) using the current set of predictors.</span></span></code></pre></div>
<p> </p>
<p>End of the Linear model with additive continuous and categorical predictors exercise</p>
<p><br />
<br />
 </p>
</div>
<div id="exercise-2-linear-model-with-interactive-continuous-and-categorical-predictors" class="section level1">
<h1>Exercise 2: Linear model with interactive continuous and categorical predictors</h1>
<p> </p>
<p>Let’s now explore this question left unanswered: “is it okay to assume the effect of <code>LOGAREA</code> to be the same for all grazing levels?” This is effectively asking if we should let the slope of <code>LOGAREA</code> vary across <code>FGRAZE</code> levels, which is the definition of an interactive effect.</p>
<p> </p>
<ol start="14" style="list-style-type: decimal">
<li>Fit the corresponding linear model in R to explain the variation in the response variable, <code>ABUND</code> with the explanatory variables <code>LOGAREA</code> and <code>FGRAZE</code> acting in interaction. Hint: this time, the acting will be done by stars <code>*</code>. Remember to use the <code>data =</code> argument. Assign this linear model to an appropriately named object, like <code>birds.inter</code>.</li>
</ol>
<p> </p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>birds.inter<span class="fl">.1</span> &lt;-<span class="st"> </span><span class="kw">lm</span>(ABUND <span class="op">~</span><span class="st"> </span>FGRAZE <span class="op">*</span><span class="st"> </span>LOGAREA , <span class="dt">data =</span> loyn)</span></code></pre></div>
<p> </p>
<ol start="15" style="list-style-type: decimal">
<li>Produce the ANOVA table using the <code>anova()</code> function on the model object. What null hypotheses are being tested? Hint: the <code>anova()</code> function performs sequential tests. Which of these hypotheses are relevant to us? Do you reject or fail to reject the null hypotheses?</li>
</ol>
<p> </p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="kw">anova</span>(birds.inter<span class="fl">.1</span>)</span>
<span id="cb18-2"><a href="#cb18-2"></a><span class="co">## Analysis of Variance Table</span></span>
<span id="cb18-3"><a href="#cb18-3"></a><span class="co">## </span></span>
<span id="cb18-4"><a href="#cb18-4"></a><span class="co">## Response: ABUND</span></span>
<span id="cb18-5"><a href="#cb18-5"></a><span class="co">##                Df Sum Sq Mean Sq F value    Pr(&gt;F)    </span></span>
<span id="cb18-6"><a href="#cb18-6"></a><span class="co">## FGRAZE          4 3453.7  863.42 26.8974 1.550e-11 ***</span></span>
<span id="cb18-7"><a href="#cb18-7"></a><span class="co">## LOGAREA         1 1153.8 1153.85 35.9447 2.942e-07 ***</span></span>
<span id="cb18-8"><a href="#cb18-8"></a><span class="co">## FGRAZE:LOGAREA  4  253.8   63.44  1.9764    0.1139    </span></span>
<span id="cb18-9"><a href="#cb18-9"></a><span class="co">## Residuals      46 1476.6   32.10                      </span></span>
<span id="cb18-10"><a href="#cb18-10"></a><span class="co">## ---</span></span>
<span id="cb18-11"><a href="#cb18-11"></a><span class="co">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb18-12"><a href="#cb18-12"></a></span>
<span id="cb18-13"><a href="#cb18-13"></a><span class="co"># null hypothesis 1: There is no effect of LOGAREA on ABUND (the coefficient for LOGAREA is zero)</span></span>
<span id="cb18-14"><a href="#cb18-14"></a><span class="co"># null hypothesis 2: There is no effect of FGRAZE on ABUND (no difference between grazing levels *after* the effect of LOGAREA)</span></span>
<span id="cb18-15"><a href="#cb18-15"></a><span class="co"># null hypothesis 3: There is no effect of an FGRAZE by ABUND interaction *after* the effects of LOGAREA and FGRAZE combined). A couple of equivalent ways to say this: the effect of LOGAREA doesn&#39;t differ among FGRAZE levels or: the difference in bird abundance between grazing levels is the same for all patch areas.</span></span>
<span id="cb18-16"><a href="#cb18-16"></a></span>
<span id="cb18-17"><a href="#cb18-17"></a><span class="co"># As long as there is an interaction in the model, the null hypotheses 1 and 2 (&quot;main effects&quot;) are not relevant to us</span></span>
<span id="cb18-18"><a href="#cb18-18"></a><span class="co"># the p value for the interaction is large, therefore we fail to reject the null hypothesis: there is no evidence supporting this interaction.</span></span></code></pre></div>
<p> </p>
<ol start="16" style="list-style-type: decimal">
<li>Use the <code>summary()</code> function on the model object to produce the table of parameter estimates. Using this output take each line in turn and answer the following questions: (A) what does this parameter represent, mathematically? (B) What is the biological interpretation of the corresponding estimate? (C) What is the null hypothesis associated with it? (D) Do you reject or fail to reject this hypothesis?</li>
</ol>
<p> </p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="kw">summary</span>(birds.inter<span class="fl">.1</span>)</span>
<span id="cb19-2"><a href="#cb19-2"></a><span class="co">## </span></span>
<span id="cb19-3"><a href="#cb19-3"></a><span class="co">## Call:</span></span>
<span id="cb19-4"><a href="#cb19-4"></a><span class="co">## lm(formula = ABUND ~ FGRAZE * LOGAREA, data = loyn)</span></span>
<span id="cb19-5"><a href="#cb19-5"></a><span class="co">## </span></span>
<span id="cb19-6"><a href="#cb19-6"></a><span class="co">## Residuals:</span></span>
<span id="cb19-7"><a href="#cb19-7"></a><span class="co">##      Min       1Q   Median       3Q      Max </span></span>
<span id="cb19-8"><a href="#cb19-8"></a><span class="co">## -16.3615  -2.3807  -0.2449   2.6181  11.3529 </span></span>
<span id="cb19-9"><a href="#cb19-9"></a><span class="co">## </span></span>
<span id="cb19-10"><a href="#cb19-10"></a><span class="co">## Coefficients:</span></span>
<span id="cb19-11"><a href="#cb19-11"></a><span class="co">##                 Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb19-12"><a href="#cb19-12"></a><span class="co">## (Intercept)       21.243      3.987   5.329 2.89e-06 ***</span></span>
<span id="cb19-13"><a href="#cb19-13"></a><span class="co">## FGRAZE2           -6.165      4.842  -1.273 0.209285    </span></span>
<span id="cb19-14"><a href="#cb19-14"></a><span class="co">## FGRAZE3           -7.215      4.820  -1.497 0.141271    </span></span>
<span id="cb19-15"><a href="#cb19-15"></a><span class="co">## FGRAZE4          -17.910      6.701  -2.673 0.010375 *  </span></span>
<span id="cb19-16"><a href="#cb19-16"></a><span class="co">## FGRAZE5          -17.043      4.406  -3.868 0.000344 ***</span></span>
<span id="cb19-17"><a href="#cb19-17"></a><span class="co">## LOGAREA            4.144      2.057   2.014 0.049843 *  </span></span>
<span id="cb19-18"><a href="#cb19-18"></a><span class="co">## FGRAZE2:LOGAREA    4.368      3.108   1.405 0.166593    </span></span>
<span id="cb19-19"><a href="#cb19-19"></a><span class="co">## FGRAZE3:LOGAREA    4.989      3.531   1.413 0.164374    </span></span>
<span id="cb19-20"><a href="#cb19-20"></a><span class="co">## FGRAZE4:LOGAREA   15.235      5.925   2.572 0.013422 *  </span></span>
<span id="cb19-21"><a href="#cb19-21"></a><span class="co">## FGRAZE5:LOGAREA    1.996      3.650   0.547 0.587148    </span></span>
<span id="cb19-22"><a href="#cb19-22"></a><span class="co">## ---</span></span>
<span id="cb19-23"><a href="#cb19-23"></a><span class="co">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb19-24"><a href="#cb19-24"></a><span class="co">## </span></span>
<span id="cb19-25"><a href="#cb19-25"></a><span class="co">## Residual standard error: 5.666 on 46 degrees of freedom</span></span>
<span id="cb19-26"><a href="#cb19-26"></a><span class="co">## Multiple R-squared:  0.767,  Adjusted R-squared:  0.7214 </span></span>
<span id="cb19-27"><a href="#cb19-27"></a><span class="co">## F-statistic: 16.83 on 9 and 46 DF,  p-value: 8.05e-12</span></span>
<span id="cb19-28"><a href="#cb19-28"></a></span>
<span id="cb19-29"><a href="#cb19-29"></a><span class="co"># Here the intercept (baseline) is the predicted `ABUND` for LOGAREA = 0, for FGRAZE level 1.</span></span>
<span id="cb19-30"><a href="#cb19-30"></a><span class="co"># the null hypothesis for the intercept is that the intercept = 0 (not biologically relevant).</span></span>
<span id="cb19-31"><a href="#cb19-31"></a></span>
<span id="cb19-32"><a href="#cb19-32"></a><span class="co"># LOGAREA represents the slope for LOGAREA, specific to level FGRAZE = 1.</span></span>
<span id="cb19-33"><a href="#cb19-33"></a><span class="co"># The null hypothesis is that the slope of the relationship</span></span>
<span id="cb19-34"><a href="#cb19-34"></a><span class="co"># between LOGAREA and ABUND = 0, for level FGRAZE = 1 only. </span></span>
<span id="cb19-35"><a href="#cb19-35"></a></span>
<span id="cb19-36"><a href="#cb19-36"></a><span class="co"># FGRAZE2...5 estimate differences (contrasts) between the *intercept* of each level and the *intercept* of the reference level, FGRAZE = 1. </span></span>
<span id="cb19-37"><a href="#cb19-37"></a></span>
<span id="cb19-38"><a href="#cb19-38"></a><span class="co"># FGRAZE2...5:LOGAREA estimate differences (contrasts) between the *slope* of LOGAREA for each level and the *slope* of LOGAREA for the reference level, FGRAZE = 1. </span></span>
<span id="cb19-39"><a href="#cb19-39"></a></span>
<span id="cb19-40"><a href="#cb19-40"></a></span>
<span id="cb19-41"><a href="#cb19-41"></a><span class="co"># The Multiple R-square value is 0.76, slightly up from the purely additive model (but not much, given that we have added a whole 4 parameters to the model, i.e. nearly doubled its complexity)</span></span></code></pre></div>
<p> </p>
<ol start="17" style="list-style-type: decimal">
<li>Check if you can make sense of the model structure, by writing down the equation of the model with the appropriate parameter estimates from the summary. Then, calculate again the predicted bird abundance (A) for a patch with LOGAREA= 2.5 and GRAZE= 1, and (B) for a patch with LOGAREA= -0.5 and GRAZE= 5.</li>
</ol>
<p> </p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="co"># ABUND = 21.243*(Intercept) - 6.165*FGRAZE2 - 7.215*FGRAZE3 - 17.910*FGRAZE4 - 17.043*FGRAZE5 + 4.144*LOGAREA + 4.368*FGRAZE2:LOGAREA + 4.989*FGRAZE3:LOGAREA + 15.235*FGRAZE4:LOGAREA + 1.996*FGRAZE5:LOGAREA</span></span>
<span id="cb20-2"><a href="#cb20-2"></a><span class="co"># Note that (Intercept) = 1 always</span></span>
<span id="cb20-3"><a href="#cb20-3"></a></span>
<span id="cb20-4"><a href="#cb20-4"></a><span class="co"># expected abundance for (A): replace LOGAREA by 2.5, and all terms involving FGRAZE2...5 by 0</span></span>
<span id="cb20-5"><a href="#cb20-5"></a><span class="fl">21.243</span><span class="op">*</span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="fl">6.165</span><span class="op">*</span><span class="dv">0</span> <span class="op">-</span><span class="st"> </span><span class="fl">7.215</span><span class="op">*</span><span class="dv">0</span> <span class="op">-</span><span class="st"> </span><span class="fl">17.910</span><span class="op">*</span><span class="dv">0</span> <span class="op">-</span><span class="st"> </span><span class="fl">17.043</span><span class="op">*</span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span><span class="fl">4.144</span><span class="op">*</span><span class="fl">2.5</span> <span class="op">+</span><span class="st"> </span><span class="fl">4.368</span><span class="op">*</span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span><span class="fl">4.989</span><span class="op">*</span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span><span class="fl">15.235</span><span class="op">*</span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span><span class="fl">1.996</span><span class="op">*</span><span class="dv">0</span> <span class="co"># 31.603</span></span>
<span id="cb20-6"><a href="#cb20-6"></a><span class="co">## [1] 31.603</span></span>
<span id="cb20-7"><a href="#cb20-7"></a></span>
<span id="cb20-8"><a href="#cb20-8"></a><span class="co"># much lower risk of error by extracting the model coefficients like this:</span></span>
<span id="cb20-9"><a href="#cb20-9"></a>birds.inter.<span class="fl">1.</span>coef&lt;-<span class="st"> </span><span class="kw">coef</span>(birds.inter<span class="fl">.1</span>)</span>
<span id="cb20-10"><a href="#cb20-10"></a>birds.inter.<span class="fl">1.</span>coef <span class="co"># check coefficients and their order</span></span>
<span id="cb20-11"><a href="#cb20-11"></a><span class="co">##     (Intercept)         FGRAZE2         FGRAZE3         FGRAZE4         FGRAZE5         LOGAREA FGRAZE2:LOGAREA </span></span>
<span id="cb20-12"><a href="#cb20-12"></a><span class="co">##       21.243012       -6.165390       -7.214949      -17.909983      -17.042997        4.143979        4.368422 </span></span>
<span id="cb20-13"><a href="#cb20-13"></a><span class="co">## FGRAZE3:LOGAREA FGRAZE4:LOGAREA FGRAZE5:LOGAREA </span></span>
<span id="cb20-14"><a href="#cb20-14"></a><span class="co">##        4.989490       15.235284        1.995647</span></span>
<span id="cb20-15"><a href="#cb20-15"></a><span class="co"># and multiply by the predictor values to obtain the equivalent prediction</span></span>
<span id="cb20-16"><a href="#cb20-16"></a><span class="kw">sum</span>(birds.inter.<span class="fl">1.</span>coef <span class="op">*</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">2.5</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>)) <span class="co"># 31.60296 </span></span>
<span id="cb20-17"><a href="#cb20-17"></a><span class="co">## [1] 31.60296</span></span>
<span id="cb20-18"><a href="#cb20-18"></a></span>
<span id="cb20-19"><a href="#cb20-19"></a><span class="co"># expected abundance for (B): input 1 for the GRAZE5 variable and -0.5 for variables LOGAREA and FGRAZE5:LOGAREA</span></span>
<span id="cb20-20"><a href="#cb20-20"></a><span class="fl">21.243</span><span class="op">*</span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="fl">6.165</span><span class="op">*</span><span class="dv">0</span> <span class="op">-</span><span class="st"> </span><span class="fl">7.215</span><span class="op">*</span><span class="dv">0</span> <span class="op">-</span><span class="st"> </span><span class="fl">17.910</span><span class="op">*</span><span class="dv">0</span> <span class="op">-</span><span class="st"> </span><span class="fl">17.043</span><span class="op">*</span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="fl">4.144</span><span class="op">*</span>(<span class="op">-</span><span class="fl">0.5</span>) <span class="op">+</span><span class="st"> </span><span class="fl">4.368</span><span class="op">*</span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span><span class="fl">4.989</span><span class="op">*</span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span><span class="fl">15.235</span><span class="op">*</span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span><span class="fl">1.996</span><span class="op">*</span>(<span class="op">-</span><span class="fl">0.5</span>) <span class="co"># 1.13</span></span>
<span id="cb20-21"><a href="#cb20-21"></a><span class="co">## [1] 1.13</span></span>
<span id="cb20-22"><a href="#cb20-22"></a><span class="co"># or</span></span>
<span id="cb20-23"><a href="#cb20-23"></a><span class="kw">sum</span>(birds.inter.<span class="fl">1.</span>coef <span class="op">*</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">-0.5</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">-0.5</span>)) <span class="co"># 1.130203 </span></span>
<span id="cb20-24"><a href="#cb20-24"></a><span class="co">## [1] 1.130203</span></span>
<span id="cb20-25"><a href="#cb20-25"></a></span>
<span id="cb20-26"><a href="#cb20-26"></a><span class="co"># Well done if you got there!</span></span></code></pre></div>
<p> </p>
<ol start="18" style="list-style-type: decimal">
<li>Now let’s check the assumptions of your linear model by creating plots of the residuals from the model. Remember, that you can split your plotting device into 2 rows and 2 columns using the <code>par()</code> function before you create the plots. Check each of the assumptions using these plots and report whether your model meets these assumptions.</li>
</ol>
<p> </p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="co"># first split the plotting device into 2 rows and 2 columns</span></span>
<span id="cb21-2"><a href="#cb21-2"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb21-3"><a href="#cb21-3"></a></span>
<span id="cb21-4"><a href="#cb21-4"></a><span class="co"># now create the residuals plots</span></span>
<span id="cb21-5"><a href="#cb21-5"></a><span class="kw">plot</span>(birds.inter<span class="fl">.1</span>)</span></code></pre></div>
<p><img src="LM_3_multiple_exercise_solutions_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a></span>
<span id="cb22-2"><a href="#cb22-2"></a><span class="co"># Not a great deal of an improvement! Just marginally better in every respect, thanks to increasing the fit slightly (by throwing lots of new model parameters at the data).</span></span></code></pre></div>
<p> </p>
<ol start="19" style="list-style-type: decimal">
<li>Let’s now plot the predictions of the interactive model to figure out how it really fits the data. Hint: the script from question 12 should work all the same, since the predictor variables involved in the equation are the same. Don’t forget to update the name of the model!</li>
</ol>
<p> </p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="kw">par</span>(<span class="dt">mfrow=</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb23-2"><a href="#cb23-2"></a><span class="kw">plot</span>(ABUND <span class="op">~</span><span class="st"> </span>LOGAREA, <span class="dt">data=</span> loyn, <span class="dt">col=</span> GRAZE, <span class="dt">pch=</span> <span class="dv">16</span>)</span>
<span id="cb23-3"><a href="#cb23-3"></a></span>
<span id="cb23-4"><a href="#cb23-4"></a><span class="co"># let&#39;s use a loop, to save repeating the following sequence 5 times:</span></span>
<span id="cb23-5"><a href="#cb23-5"></a><span class="cf">for</span>(g <span class="cf">in</span> <span class="kw">levels</span>(loyn<span class="op">$</span>FGRAZE)){<span class="co"># `g` will take the values &quot;1&quot;, &quot;2&quot;, &quot;3&quot;, &quot;4&quot; and &quot;5&quot; in turn</span></span>
<span id="cb23-6"><a href="#cb23-6"></a>    LOGAREA.seq&lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dt">from=</span> <span class="kw">min</span>(loyn<span class="op">$</span>LOGAREA[loyn<span class="op">$</span>FGRAZE <span class="op">==</span><span class="st"> </span>g]),</span>
<span id="cb23-7"><a href="#cb23-7"></a>                                        <span class="dt">to=</span> <span class="kw">max</span>(loyn<span class="op">$</span>LOGAREA[loyn<span class="op">$</span>FGRAZE <span class="op">==</span><span class="st"> </span>g]),</span>
<span id="cb23-8"><a href="#cb23-8"></a>                                                        <span class="dt">length=</span> <span class="dv">20</span>)</span>
<span id="cb23-9"><a href="#cb23-9"></a>    dat4pred&lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">FGRAZE=</span> g, <span class="dt">LOGAREA=</span> LOGAREA.seq)</span>
<span id="cb23-10"><a href="#cb23-10"></a>    dat4pred<span class="op">$</span>predicted&lt;-<span class="st"> </span><span class="kw">predict</span>(birds.inter<span class="fl">.1</span>, <span class="dt">newdata=</span> dat4pred)</span>
<span id="cb23-11"><a href="#cb23-11"></a>    <span class="kw">lines</span>(predicted <span class="op">~</span><span class="st"> </span>LOGAREA, <span class="dt">data=</span> dat4pred, <span class="dt">col=</span> <span class="kw">as.numeric</span>(g), <span class="dt">lwd=</span> <span class="dv">2</span>)</span>
<span id="cb23-12"><a href="#cb23-12"></a>}</span></code></pre></div>
<p><img src="LM_3_multiple_exercise_solutions_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<p> </p>
<ol start="20" style="list-style-type: decimal">
<li>Do you think the model is biologically plausible? Is it supported statistically?</li>
</ol>
<p> </p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="co"># The slopes of the LOGAREA effect across grazing levels are all over the place, without any coherent pattern (for instance, they could have been increasing or decreasing gradually from low to high grazing intensity)</span></span>
<span id="cb24-2"><a href="#cb24-2"></a></span>
<span id="cb24-3"><a href="#cb24-3"></a><span class="co"># The interaction is non-significant, so isn&#39;t supported statistically either.</span></span>
<span id="cb24-4"><a href="#cb24-4"></a></span>
<span id="cb24-5"><a href="#cb24-5"></a><span class="co"># Time to revert to the simpler, or a different model? More on this in the next session!</span></span></code></pre></div>
<p> </p>
<p>End of the Linear model with interactive continuous and categorical predictors exercise</p>
<p><br />
</p>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
